(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var i=r(6658),n=r(1999),c=r.n(n),s=r(9242),a=r(8209);function l(){let{cart:e,increaseQty:t,decreaseQty:r,removeFromCart:n}=(0,a._)();return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"購物車內容"}),0===e.length?(0,i.jsx)("p",{children:"你的購物車是空的"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("ul",{children:e.map((e,s)=>(0,i.jsxs)("li",{children:[(0,i.jsx)(c(),{href:"/product/".concat(e.category,"/").concat(e.id),style:{marginRight:"1rem"},children:e.name}),(0,i.jsxs)("div",{children:["數量: ",e.quantity,(0,i.jsx)("button",{onClick:()=>r(e.id),style:{marginLeft:"0.5rem"},children:"➖"}),(0,i.jsx)("button",{onClick:()=>t(e.id),style:{marginLeft:"0.5rem"},children:"➕"}),(0,i.jsx)("button",{onClick:()=>n(e.id),style:{marginLeft:"0.5rem"},children:"\uD83D\uDDD1️"})]}),(0,i.jsxs)("div",{children:["小計：$",(e.price*e.quantity).toFixed(2)]})]},s))}),(0,i.jsx)("div",{style:{marginTop:"1rem"},children:(0,i.jsx)(c(),{href:"/checkout",children:(0,i.jsx)("button",{style:{marginLeft:"1rem"},children:"\uD83D\uDCB8 前往結帳"})})})]})]})}function d(){let{addToCart:e}=(0,a._)(),[t,r]=(0,s.useState)([]),[n,d]=(0,s.useState)({}),[o,u]=(0,s.useState)(!0),[h,m]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("https://carolhyl.github.io/kokikoichi/products.json");if(!e.ok)throw Error("Failed to fetch");let t=await e.json();r(t);let i={};t.forEach(e=>{i[e.category]||(i[e.category]=[]),i[e.category].push(e)}),d(i)}catch(e){console.error(e),m(!0)}finally{u(!1)}})()},[]),(0,i.jsxs)("main",{style:{padding:"2rem"},children:[(0,i.jsx)("h1",{children:"\uD83D\uDED2 My Shopping Site"}),(0,i.jsx)(l,{}),o&&(0,i.jsx)("p",{children:"載入中..."}),h&&(0,i.jsx)("p",{children:"發生錯誤，請稍後再試。"}),!o&&!h&&(0,i.jsx)(i.Fragment,{children:Object.keys(n).map(t=>(0,i.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,i.jsx)(c(),{href:"/product/".concat(t),style:{marginLeft:"1rem"},children:(0,i.jsxs)("h2",{children:["\uD83D\uDCC2 ",t]})}),(0,i.jsx)("ul",{children:n[t].map(t=>(0,i.jsxs)("li",{style:{marginBottom:"0.5rem"},children:[(0,i.jsx)(c(),{href:"/product/".concat(t.category,"/").concat(t.id),children:t.name}),(0,i.jsx)("button",{onClick:()=>e(t),style:{marginLeft:"1rem"},children:"加入購物車"})]},t.id))})]},t))})]})}},6303:(e,t,r)=>{Promise.resolve().then(r.bind(r,2518))},8209:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>s,_:()=>a});var i=r(6658),n=r(9242);let c=(0,n.createContext)();function s(e){let{children:t}=e,[r,s]=(0,n.useState)([]);return(0,n.useEffect)(()=>{let e=localStorage.getItem("cart");e&&s(JSON.parse(e))},[]),(0,n.useEffect)(()=>{console.log("\uD83E\uDDFA 購物車更新:",r),localStorage.setItem("cart",JSON.stringify(r))},[r]),(0,i.jsx)(c.Provider,{value:{cart:r,addToCart:e=>{s(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{...e,quantity:1}])},removeFromCart:e=>{s(t=>t.filter(t=>t.id!==e))},increaseQty:e=>{s(t=>t.map(t=>t.id===e?{...t,quantity:t.quantity+1}:t))},decreaseQty:e=>{s(t=>t.map(t=>t.id===e?{...t,quantity:t.quantity-1}:t).filter(e=>e.quantity>0))},clearCart:()=>s([])},children:t})}let a=()=>(0,n.useContext)(c)}},e=>{var t=t=>e(e.s=t);e.O(0,[999,773,261,358],()=>t(6303)),_N_E=e.O()}]);